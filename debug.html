<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>Display a map</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.css' rel='stylesheet' />
<style>
body { margin:0; padding:0; }
#map {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 100%;
}
</style>
</head>
<body>
 
<div id='map'></div>

<style>
#menu {
    position: absolute;
    left:  0.5em;
    top: 0.5em; 
    padding: 0.2em 0.5em;
    margin: 0 0;
    background: #ddeeff;
    box-shadow: 0px 0px 0px 5px #ddeeff;
    border: dashed 3px #aaccff;
    font-family: 'Open Sans', sans-serif;
    width: 90%;
    max-width: 350px;
}
</style>


<div id='menu'>
  <h1 class="titlebox" style="font-size: 100%; margin: 0 0;">
  <a href="https://github.com/gsi-cyberjapan/gsimaps-vector-experiment" target="_blank">地理院地図Vector</a>のスタイルをシンプルな<a href="https://docs.mapbox.com/mapbox-gl-js/overview/" target="_blank">Mapbox GL JS</a>で実装する試み（第2弾）</h1>
  <div id="stylelist">
    <input id='std' type='radio' name='rtoggle' value='std' checked='checked'>
    <label for='std'>標準地図</label>
    <input id='pale' type='radio' name='rtoggle' value='pale'>
    <label for='pale'>淡色地図</label>
    <input id='blank' type='radio' name='rtoggle' value='blank'>
    <label for='blank'>白地図</label>
  </div>
  <input type="button" value="タイル境界" onClick="switchTileBound()">
  <input type="button" value="衝突範囲" onClick="switchCollisionBoxes()">
</div>

<script>
var map = new mapboxgl.Map({
  container: 'map', // container id
  hash: true, //add #position on URL
  style: './std.json', // stylesheet location
  center: [139.78148, 35.768793], // starting position [lng, lat]
  zoom: 4, // starting zoom
  localIdeographFontFamily: false
});


//Add Images
_addImages();

function _addImages(){
  //blank
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-255,255,255,1-255,255,255,0.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-255,255,255,1-255,255,255,0', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-255,255,255,1-255,255,255,1.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-255,255,255,1-255,255,255,1', image);
  });

  //pale
  map.loadImage('./hatch/-gsibv-hatch-cross-4-210,210,210,1-255,255,255,1.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-cross-4-210,210,210,1-255,255,255,1', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-dot-4-230,230,230,1-.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-dot-4-230,230,230,1-', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-200,200,200,1-200,200,200,1.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-200,200,200,1-200,200,200,1', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-200,200,200,1-255,255,255,1.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-200,200,200,1-255,255,255,1', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-210,210,210,1-255,255,255,0.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-210,210,210,1-255,255,255,0', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-210,210,210,1-255,255,255,1.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-210,210,210,1-255,255,255,1', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-minus-12-230,230,230,1-.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-minus-12-230,230,230,1-', image);
  });

  //std
  map.loadImage('./hatch/-gsibv-hatch-cross-4-255,135,75,1-255,255,255,1.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-cross-4-255,135,75,1-255,255,255,1', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-255,135,75,1-255,255,255,1.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-255,135,75,1-255,255,255,1', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-ltrb-4-255,135,75,1-255,255,255,0.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-ltrb-4-255,135,75,1-255,255,255,0', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-dot-4-200,160,60,1-.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-dot-4-200,160,60,1-', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-minus-12-20,90,255,1-.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-minus-12-20,90,255,1-', image);
  });
  map.loadImage('./hatch/-gsibv-hatch-dot-4-20,90,255,1-.png', function(error, image) {
    if (error) throw error;
    map.addImage('-gsibv-hatch-dot-4-20,90,255,1-', image);
  });
}

map.addControl(new mapboxgl.NavigationControl(), 'bottom-right');
map.addControl(new mapboxgl.ScaleControl() );
map.showTileBoundaries = true;
map.showCollisionBoxes() = true;

function switchTileBound(){
  map.showTileBoundaries = !map.showTileBoundaries;
}

function switchCollisionBoxes(){
  map.showCollisionBoxes = !map.showCollisionBoxes;
}


var layerList = document.getElementById('stylelist');
var inputs = layerList.getElementsByTagName('input');
 
function switchLayer(layer) {
  var layerId = layer.target.id;
  _addImages();
  map.setStyle('./' + layerId +'.json', {
    localIdeographFontFamily: false,
    diff: false
  });
}
 
for (var i = 0; i < inputs.length; i++) {
  inputs[i].onclick = switchLayer;
}



</script>
 
</body>
</html>